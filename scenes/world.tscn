[gd_scene load_steps=19 format=3 uid="uid://bjvbg67qq86db"]

[ext_resource type="PackedScene" uid="uid://csinpw556o7ux" path="res://scenes/player.tscn" id="1_10ho3"]
[ext_resource type="Script" path="res://scripts/world.gd" id="1_se2w6"]
[ext_resource type="Texture2D" uid="uid://lhvhnunejvve" path="res://sprites/plain_boime.png" id="2_l0pn6"]
[ext_resource type="PackedScene" uid="uid://cp030u4v4at67" path="res://scenes/goblin.tscn" id="4_4jbbu"]
[ext_resource type="Texture2D" uid="uid://c43p5kqhy370s" path="res://texures/heart.png" id="5_vj55y"]
[ext_resource type="PackedScene" uid="uid://rfoyb3i878pc" path="res://scenes/lose_scene.tscn" id="6_83dxx"]
[ext_resource type="Script" path="res://scripts/Hearts.gd" id="6_hv15k"]
[ext_resource type="Script" path="res://scripts/MaxHearts.gd" id="8_qgpxq"]
[ext_resource type="Shader" path="res://shader/dying.gdshader" id="8_tthfh"]
[ext_resource type="Script" path="res://scripts/spawner.gd" id="9_l8cwq"]
[ext_resource type="PackedScene" uid="uid://c1agv22pvbvaj" path="res://scenes/winning_scene.tscn" id="10_45iw7"]
[ext_resource type="PackedScene" uid="uid://bacveih6couh6" path="res://scenes/map.tscn" id="11_8baoh"]
[ext_resource type="AudioStream" uid="uid://cmxyqbek488ch" path="res://sounds/mixkit-battle-man-scream-2175.wav" id="11_54gj3"]

[sub_resource type="TileMapPattern" id="TileMapPattern_r5abn"]
tile_data = PackedInt32Array(0, 0, 2, 1, 0, 2)

[sub_resource type="NavigationPolygon" id="NavigationPolygon_33fmx"]
vertices = PackedVector2Array(64, 64, -64, 64, -64, -64, 64, -64)
polygons = Array[PackedInt32Array]([PackedInt32Array(0, 1, 2, 3)])
outlines = Array[PackedVector2Array]([PackedVector2Array(-64, -64, 64, -64, 64, 64, -64, 64)])
source_geometry_group_name = &"navigation_polygon_source_group"
agent_radius = 0.0

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_hvayt"]
resource_name = "plain_boime"
texture = ExtResource("2_l0pn6")
texture_region_size = Vector2i(128, 128)
0:0/0 = 0
0:0/0/terrain_set = 0
0:0/0/terrain = 0
0:0/0/physics_layer_0/linear_velocity = Vector2(0, 0)
0:0/0/physics_layer_0/angular_velocity = 0.0
0:0/0/terrains_peering_bit/right_side = 0
0:0/0/terrains_peering_bit/bottom_right_corner = 0
0:0/0/terrains_peering_bit/bottom_side = 0
0:0/0/terrains_peering_bit/bottom_left_corner = 0
0:0/0/terrains_peering_bit/left_side = 0
0:0/0/terrains_peering_bit/top_left_corner = 0
0:0/0/terrains_peering_bit/top_side = 0
0:0/0/terrains_peering_bit/top_right_corner = 0
0:0/0/navigation_layer_0/polygon = SubResource("NavigationPolygon_33fmx")
1:0/0 = 0
1:0/0/terrain_set = 0
1:0/0/terrain = 0
1:0/0/physics_layer_0/linear_velocity = Vector2(0, 0)
1:0/0/physics_layer_0/angular_velocity = 0.0
1:0/0/terrains_peering_bit/right_side = 0
1:0/0/terrains_peering_bit/bottom_right_corner = 0
1:0/0/terrains_peering_bit/bottom_side = 0
1:0/0/terrains_peering_bit/bottom_left_corner = 0
1:0/0/terrains_peering_bit/left_side = 0
1:0/0/terrains_peering_bit/top_left_corner = 0
1:0/0/terrains_peering_bit/top_side = 0
1:0/0/terrains_peering_bit/top_right_corner = 0
1:0/0/navigation_layer_0/polygon = SubResource("NavigationPolygon_33fmx")
0:1/0 = 0
0:1/0/terrain_set = 0
0:1/0/terrain = 0
0:1/0/physics_layer_0/linear_velocity = Vector2(0, 0)
0:1/0/physics_layer_0/angular_velocity = 0.0
0:1/0/terrains_peering_bit/right_side = 0
0:1/0/terrains_peering_bit/bottom_right_corner = 0
0:1/0/terrains_peering_bit/bottom_side = 0
0:1/0/terrains_peering_bit/bottom_left_corner = 0
0:1/0/terrains_peering_bit/left_side = 0
0:1/0/terrains_peering_bit/top_left_corner = 0
0:1/0/terrains_peering_bit/top_side = 0
0:1/0/terrains_peering_bit/top_right_corner = 0
0:1/0/navigation_layer_0/polygon = SubResource("NavigationPolygon_33fmx")
0:2/0 = 0
0:2/0/terrain_set = 0
0:2/0/terrain = 0
0:2/0/physics_layer_0/linear_velocity = Vector2(0, 0)
0:2/0/physics_layer_0/angular_velocity = 0.0
0:2/0/physics_layer_0/polygon_0/points = PackedVector2Array(-64, -64, 64, -64, 64, 64, -64, 64)
0:2/0/terrains_peering_bit/right_side = 0
0:2/0/terrains_peering_bit/bottom_right_corner = 0
0:2/0/terrains_peering_bit/bottom_side = 0
0:2/0/terrains_peering_bit/bottom_left_corner = 0
0:2/0/terrains_peering_bit/left_side = 0
0:2/0/terrains_peering_bit/top_left_corner = 0
0:2/0/terrains_peering_bit/top_side = 0
0:2/0/terrains_peering_bit/top_right_corner = 0
1:1/0 = 0
1:1/0/physics_layer_0/linear_velocity = Vector2(0, 0)
1:1/0/physics_layer_0/angular_velocity = 0.0

[sub_resource type="TileSet" id="TileSet_upu07"]
tile_size = Vector2i(128, 128)
physics_layer_0/collision_layer = 1
terrain_set_0/mode = 0
terrain_set_0/terrain_0/name = "Terrain 0"
terrain_set_0/terrain_0/color = Color(0.501961, 0.345098, 0.25098, 1)
navigation_layer_0/layers = 1
sources/0 = SubResource("TileSetAtlasSource_hvayt")
pattern_0 = SubResource("TileMapPattern_r5abn")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_75xxt"]
shader = ExtResource("8_tthfh")
shader_parameter/use_grayscale = true
shader_parameter/shift_color = Color(0.81, 0.81, 0.81, 1)

[node name="World" type="Node2D"]
script = ExtResource("1_se2w6")

[node name="Player" parent="." instance=ExtResource("1_10ho3")]
z_index = 10
position = Vector2(21, 401)

[node name="TileMap" type="TileMap" parent="."]
position = Vector2(-146, 309)
tile_set = SubResource("TileSet_upu07")
format = 2

[node name="Goblin" parent="." instance=ExtResource("4_4jbbu")]
position = Vector2(-452, 28)

[node name="Goblin2" parent="." instance=ExtResource("4_4jbbu")]
position = Vector2(-384, -38)

[node name="UI" type="CanvasLayer" parent="."]

[node name="WinningScene" parent="UI" instance=ExtResource("10_45iw7")]
visible = false

[node name="LoseScene" parent="UI" instance=ExtResource("6_83dxx")]
visible = false

[node name="Map" parent="UI" instance=ExtResource("11_8baoh")]

[node name="Life" type="Control" parent="UI"]
layout_mode = 3
anchor_left = 0.123
anchor_top = 0.899
anchor_right = 0.123
anchor_bottom = 0.899
offset_left = -0.639999
offset_top = 0.0499268
offset_right = 39.36
offset_bottom = 40.0499
grow_vertical = 0

[node name="Hearts" type="TextureRect" parent="UI/Life"]
z_index = 1
layout_mode = 0
offset_right = 1420.0
offset_bottom = 128.0
scale = Vector2(0.3, 0.3)
texture = ExtResource("5_vj55y")
expand_mode = 1
stretch_mode = 1
script = ExtResource("6_hv15k")

[node name="MaxHearts" type="TextureRect" parent="UI/Life"]
material = SubResource("ShaderMaterial_75xxt")
layout_mode = 0
offset_right = 1420.0
offset_bottom = 128.0
scale = Vector2(0.3, 0.3)
texture = ExtResource("5_vj55y")
expand_mode = 2
stretch_mode = 1
script = ExtResource("8_qgpxq")

[node name="Kill" type="Label" parent="UI"]
offset_right = 40.0
offset_bottom = 23.0
theme_override_colors/font_color = Color(0.878431, 0, 0, 1)
theme_override_font_sizes/font_size = 25
text = "Kill: 0"

[node name="Spawner" type="Node" parent="."]
script = ExtResource("9_l8cwq")
internval_seconds = 3
enable = false

[node name="WinningSound" type="AudioStreamPlayer2D" parent="."]
stream = ExtResource("11_54gj3")
attenuation = 0.000150286
bus = &"SFX"

[node name="SpawnerStarter" type="Timer" parent="."]
one_shot = true

[connection signal="health_change" from="Player" to="UI/Life" method="_on_player_health_change"]
[connection signal="health_change" from="Player" to="UI/Life/Hearts" method="_on_player_health_change"]
[connection signal="hero_death" from="Player" to="." method="_on_player_hero_death"]
[connection signal="map_pos_change" from="Player" to="UI/Map" method="_on_player_map_pos_change"]
[connection signal="max_health_change" from="Player" to="UI/Life/MaxHearts" method="_on_player_max_health_change"]
[connection signal="timeout" from="SpawnerStarter" to="." method="_on_spawner_starter_timeout"]
